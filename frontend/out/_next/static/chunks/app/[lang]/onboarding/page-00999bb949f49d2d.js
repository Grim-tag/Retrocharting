(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[717],{85791:(e,t,r)=>{Promise.resolve().then(r.bind(r,96713))},80022:(e,t,r)=>{"use strict";r.d(t,{G_:()=>n,j:()=>i});var o=r(12115);let a=(0,o.createContext)(null);function n(e){let{clientId:t,nonce:r,onScriptLoadSuccess:n,onScriptLoadError:l,children:i}=e,c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{nonce:t,onScriptLoadSuccess:r,onScriptLoadError:a}=e,[n,l]=(0,o.useState)(!1),i=(0,o.useRef)(r);i.current=r;let c=(0,o.useRef)(a);return c.current=a,(0,o.useEffect)(()=>{let e=document.createElement("script");return e.src="https://accounts.google.com/gsi/client",e.async=!0,e.defer=!0,e.nonce=t,e.onload=()=>{var e;l(!0),null===(e=i.current)||void 0===e||e.call(i)},e.onerror=()=>{var e;l(!1),null===(e=c.current)||void 0===e||e.call(c)},document.body.appendChild(e),()=>{document.body.removeChild(e)}},[t]),n}({nonce:r,onScriptLoadSuccess:n,onScriptLoadError:l}),u=(0,o.useMemo)(()=>({clientId:t,scriptLoadedSuccessfully:c}),[t,c]);return o.createElement(a.Provider,{value:u},i)}let l={large:40,medium:32,small:20};function i(e){let{onSuccess:t,onError:r,useOneTap:n,promptMomentNotification:i,type:c="standard",theme:u="outline",size:s="large",text:d,shape:h,logo_alignment:v,width:f,locale:m,click_listener:g,containerProps:p,...y}=e,w=(0,o.useRef)(null),{clientId:b,scriptLoadedSuccessfully:x}=function(){let e=(0,o.useContext)(a);if(!e)throw Error("Google OAuth components must be used within GoogleOAuthProvider");return e}(),_=(0,o.useRef)(t);_.current=t;let E=(0,o.useRef)(r);E.current=r;let S=(0,o.useRef)(i);return S.current=i,(0,o.useEffect)(()=>{var e,t,r,o,a,l,i,p,j;if(x)return null===(r=null===(t=null===(e=null==window?void 0:window.google)||void 0===e?void 0:e.accounts)||void 0===t?void 0:t.id)||void 0===r||r.initialize({client_id:b,callback:e=>{var t,r;if(!(null==e?void 0:e.credential))return null===(t=E.current)||void 0===t?void 0:t.call(E);let{credential:o,select_by:a}=e;_.current({credential:o,clientId:null!==(r=null==e?void 0:e.clientId)&&void 0!==r?r:null==e?void 0:e.client_id,select_by:a})},...y}),null===(l=null===(a=null===(o=null==window?void 0:window.google)||void 0===o?void 0:o.accounts)||void 0===a?void 0:a.id)||void 0===l||l.renderButton(w.current,{type:c,theme:u,size:s,text:d,shape:h,logo_alignment:v,width:f,locale:m,click_listener:g}),n&&(null===(j=null===(p=null===(i=null==window?void 0:window.google)||void 0===i?void 0:i.accounts)||void 0===p?void 0:p.id)||void 0===j||j.prompt(S.current)),()=>{var e,t,r;n&&(null===(r=null===(t=null===(e=null==window?void 0:window.google)||void 0===e?void 0:e.accounts)||void 0===t?void 0:t.id)||void 0===r||r.cancel())}},[b,x,n,c,u,s,d,h,v,f,m]),o.createElement("div",{...p,ref:w,style:{height:l[s],...null==p?void 0:p.style}})}},76046:(e,t,r)=>{"use strict";var o=r(66658);r.o(o,"useParams")&&r.d(t,{useParams:function(){return o.useParams}}),r.o(o,"usePathname")&&r.d(t,{usePathname:function(){return o.usePathname}}),r.o(o,"useRouter")&&r.d(t,{useRouter:function(){return o.useRouter}}),r.o(o,"useSearchParams")&&r.d(t,{useSearchParams:function(){return o.useSearchParams}})},96713:(e,t,r)=>{"use strict";r.d(t,{default:()=>c});var o=r(95155),a=r(12115),n=r(68435),l=r(85534),i=r(76046);function c(e){let{lang:t}=e,{user:r,token:c,refreshUser:u}=(0,n.A)(),[s,d]=(0,a.useState)(""),[h,v]=(0,a.useState)(""),[f,m]=(0,a.useState)(!1),g=(0,i.useRouter)(),p=async e=>{if(e.preventDefault(),v(""),!s||s.length<3){v("Username must be at least 3 characters.");return}m(!0);try{await (0,l.TK)(c,{username:s}),await u(),g.push("/".concat(t,"/collection"))}catch(e){v("Username already taken or invalid.")}finally{m(!1)}};return r?(0,o.jsx)("div",{className:"min-h-screen bg-[#0f121e] flex flex-col items-center justify-center p-4 text-white",children:(0,o.jsxs)("div",{className:"max-w-md w-full bg-[#1f2533] border border-[#2a3142] rounded-xl p-8 shadow-2xl",children:[(0,o.jsxs)("div",{className:"text-center mb-8",children:[(0,o.jsx)("img",{src:r.avatar_url,alt:"Avatar",className:"w-20 h-20 rounded-full mx-auto mb-4 border-4 border-[#ff6600]"}),(0,o.jsx)("h1",{className:"text-2xl font-bold mb-2",children:"Welcome!"}),(0,o.jsx)("p",{className:"text-gray-400",children:"Please choose a unique username to start your collection."})]}),(0,o.jsxs)("form",{onSubmit:p,children:[(0,o.jsxs)("div",{className:"mb-6",children:[(0,o.jsx)("label",{className:"block text-sm font-bold mb-2 text-gray-300",children:"Username"}),(0,o.jsx)("input",{type:"text",className:"w-full bg-[#0f121e] border border-[#3a4152] rounded p-3 text-white focus:border-[#ff6600] outline-none transition-colors",placeholder:"e.g. RetroKing99",value:s,onChange:e=>d(e.target.value)}),h&&(0,o.jsx)("p",{className:"text-red-500 text-xs mt-2",children:h})]}),(0,o.jsx)("button",{type:"submit",disabled:f,className:"w-full bg-[#ff6600] hover:bg-[#e65c00] text-white font-bold py-3 rounded-lg transition-colors disabled:opacity-50",children:f?"Setting up...":"Start Collecting"})]})]})}):null}},68435:(e,t,r)=>{"use strict";r.d(t,{A:()=>u,AuthProvider:()=>c});var o=r(95155),a=r(12115),n=r(80022),l=r(85534);let i=(0,a.createContext)(void 0);function c(e){let{children:t}=e,[r,c]=(0,a.useState)(null),[u,s]=(0,a.useState)(null),[d,h]=(0,a.useState)(!0);(0,a.useEffect)(()=>{let e=localStorage.getItem("rc_token");e?(s(e),(0,l.Ni)(e).then(e=>{e?c(e):f()}).finally(()=>h(!1))):h(!1)},[]);let v=async e=>{let t=await (0,l.XL)(e);t&&t.access_token&&(localStorage.setItem("rc_token",t.access_token),s(t.access_token),c(await (0,l.Ni)(t.access_token)))},f=()=>{localStorage.removeItem("rc_token"),s(null),c(null)},m="dummy-client-id-for-static-build";m||console.error("CRITICAL: NEXT_PUBLIC_GOOGLE_CLIENT_ID is missing. Google Login will fail.");let g=async()=>{u&&c(await (0,l.Ni)(u))};return(0,o.jsx)(n.G_,{clientId:m,children:(0,o.jsx)(i.Provider,{value:{user:r,token:u,login:v,logout:f,refreshUser:g,isAuthenticated:!!r,loading:d},children:t})})}function u(){let e=(0,a.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},85534:(e,t,r)=>{"use strict";r.d(t,{$_:()=>w,CG:()=>_,Go:()=>E,Li:()=>f,Ni:()=>d,R1:()=>n,Ri:()=>l,Sb:()=>m,Sk:()=>u,Sz:()=>c,TK:()=>g,UQ:()=>i,XL:()=>s,X_:()=>h,bC:()=>p,e9:()=>a,fA:()=>x,jg:()=>y,mQ:()=>b,nL:()=>v});var o=r(93681);function a(){return o.H}async function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,r=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,i=arguments.length>6?arguments[6]:void 0;try{return(await o.u.get("/products",{params:{console:e,limit:t,genre:r,type:a,sort:n,skip:l,search:i}})).data}catch(e){return console.error("Error fetching products:",e),[]}}async function l(e){try{return(await o.u.get("/products/search/grouped",{params:{query:e}})).data}catch(e){return console.error("Error searching products grouped:",e),{}}}async function i(e){try{let t=await o.u.get("/products/".concat(e,"/listings"),{params:{_t:new Date().getTime()}}),r="true"===t.headers["x-is-stale"];return{data:t.data,isStale:r,status:t.status}}catch(e){var t;return{data:[],isStale:!1,status:(null===(t=e.response)||void 0===t?void 0:t.status)||500}}}async function c(e){try{return(await o.u.get("/products/".concat(e,"/related"))).data}catch(e){return console.error("Error fetching related products:",e),[]}}async function u(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,r=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,l=arguments.length>5?arguments[5]:void 0,i=arguments.length>6?arguments[6]:void 0;try{return(await o.u.get("/games/",{params:{console:e,limit:t,genre:r,type:i,sort:a,skip:n,search:l}})).data}catch(e){return console.error("Error fetching games:",e),[]}}async function s(e){try{return(await o.u.post("/auth/google",{credential:e})).data}catch(e){var t,r;throw console.error("Google Login failed",e),Error((null===(r=e.response)||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.detail)||e.message||"Login failed")}}async function d(e){try{return(await o.u.get("/auth/me")).data}catch(e){return null}}async function h(e){try{return(await o.u.get("/collection/")).data}catch(e){return console.error("Failed to fetch collection",e),[]}}async function v(e,t,r,a,n){try{return(await o.u.post("/collection/",{product_id:t,condition:r,paid_price:n,notes:a})).data}catch(e){var l,i;throw console.error("Failed to add to collection",e),Error((null===(i=e.response)||void 0===i?void 0:null===(l=i.data)||void 0===l?void 0:l.detail)||"Failed to add to collection")}}async function f(e,t,r){try{return(await o.u.put("/collection/".concat(t),r)).data}catch(e){var a,n;throw console.error("Failed to update collection item",e),Error((null===(n=e.response)||void 0===n?void 0:null===(a=n.data)||void 0===a?void 0:a.detail)||"Failed to update item")}}async function m(e,t){try{return await o.u.delete("/collection/".concat(t)),!0}catch(e){return console.error("Failed to delete item",e),!1}}async function g(e,t){try{return(await o.u.put("/auth/me",t)).data}catch(e){throw e}}async function p(e){try{return(await o.u.get("/portfolio/summary")).data}catch(e){return console.error("Failed to fetch portfolio summary",e),{total_value:0,item_count:0,console_count:0,top_items:[]}}}async function y(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;try{return(await o.u.get("/portfolio/history",{params:{range_days:t}})).data}catch(e){return console.error("Failed to fetch portfolio history",e),[]}}async function w(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;try{return(await o.u.get("/portfolio/movers",{params:{days:t}})).data}catch(e){return console.error("Failed to fetch portfolio movers",e),{gainers:[],losers:[]}}}async function b(e){try{return(await o.u.get("/portfolio/debug")).data}catch(e){return console.error("Failed to fetch portfolio debug",e),{error:"Failed to fetch debug info"}}}async function x(e){try{return(await o.u.get("/portfolio/dashboard")).data}catch(e){return console.error("Failed to fetch portfolio dashboard",e),null}}async function _(e,t){let r=new FormData;r.append("file",e);try{return(await o.u.post("/import/upload",r,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(e){var a,n;throw console.error("CSV upload failed",e),Error((null===(n=e.response)||void 0===n?void 0:null===(a=n.data)||void 0===a?void 0:a.detail)||"Upload failed")}}async function E(e,t){try{return(await o.u.post("/import/confirm",{items:e})).data}catch(e){var r,a;throw console.error("Bulk import failed",e),Error((null===(a=e.response)||void 0===a?void 0:null===(r=a.data)||void 0===r?void 0:r.detail)||"Import failed")}}},93681:(e,t,r)=>{"use strict";r.d(t,{H:()=>a,u:()=>n});var o=r(82651);let a="".concat("http://127.0.0.1:8000","/api/v1"),n=o.A.create({baseURL:a,timeout:12e4,headers:{"Content-Type":"application/json"}});n.interceptors.request.use(e=>{{let t=localStorage.getItem("rc_token");t&&(e.headers.Authorization="Bearer ".concat(t))}return e},e=>Promise.reject(e)),n.interceptors.response.use(e=>e,e=>Promise.reject(e))}},e=>{var t=t=>e(e.s=t);e.O(0,[651,441,517,358],()=>t(85791)),_N_E=e.O()}]);