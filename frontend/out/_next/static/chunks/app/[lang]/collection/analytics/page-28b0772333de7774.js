(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[547],{87181:(e,t,r)=>{Promise.resolve().then(r.bind(r,18798))},18798:(e,t,r)=>{"use strict";r.d(t,{default:()=>u});var s=r(95155),l=r(12115),a=r(68435),i=r(85534),n=r(76046),d=r(11977),o=r(31558),c=r(85572),x=r(36),b=r(15255),m=r(12800),p=r(66963),h=r(71214),f=r(85093);function u(){var e,t;let{token:r,isAuthenticated:u}=(0,a.A)();(0,n.useRouter)();let{currency:g}=(0,o.H)(),[v,j]=(0,l.useState)(null),[N,y]=(0,l.useState)([]),[k,w]=(0,l.useState)(null),[_,T]=(0,l.useState)(null),[C,D]=(0,l.useState)(!0),[S,O]=(0,l.useState)(!1),[$,V]=(0,l.useState)("");if((0,l.useEffect)(()=>{O(!0),V(new Date().toLocaleDateString())},[]),(0,l.useEffect)(()=>{u&&e();async function e(){if(r){D(!0);try{let[e,t,s]=await Promise.all([(0,i.bC)(r),(0,i.jg)(r,-1),(0,i.$_)(r,30)]);if(j(e),y(t),w(s),!t||0===t.length){let e=await (0,i.mQ)(r);T(e)}}catch(e){console.error("Failed to load analytics data",e)}finally{D(!1)}}}},[r,u]),!S)return null;if(!u)return(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-[#0f121e] text-white",children:(0,s.jsx)("p",{children:"Please log in to view your portfolio analytics."})});if(C)return(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-[#0f121e] text-white",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-[#ff6600]"})});let E=(0,d.Tt)((null==v?void 0:v.total_value)||0,g),G=(0,d.Tt)((null==v?void 0:v.total_invested)||0,g),L=(0,d.Tt)((null==v?void 0:v.total_profit)||0,g),P=Array.isArray(N)?N.map(e=>({...e,value:(0,d.Tt)(e.value||0,g),invested:(0,d.Tt)(e.invested||0,g)})):[];return(0,s.jsx)("div",{className:"min-h-screen bg-[#0f121e] py-8 text-white print:bg-white print:text-black",children:(0,s.jsxs)("div",{className:"max-w-[1400px] mx-auto px-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-8 print:hidden",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"Portfolio Analytics"}),(0,s.jsx)("p",{className:"text-gray-400",children:"Track your collection value and performance."})]}),(0,s.jsx)("button",{onClick:()=>window.print(),className:"bg-[#2a3142] hover:bg-[#353e54] text-white font-bold py-2 px-4 rounded border border-[#3a4152]",children:"\uD83D\uDDA8️ Print Report"})]}),(0,s.jsxs)("div",{className:"hidden print:block mb-8 border-b-2 border-black pb-4",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold",children:"Collection Valuation Report"}),(0,s.jsxs)("p",{className:"text-gray-600",children:["Generated on ",$]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,s.jsxs)("div",{className:"bg-[#1f2533] p-6 rounded-xl border border-[#2a3142] print:border-black print:bg-white",children:[(0,s.jsx)("h3",{className:"text-gray-400 uppercase text-xs font-bold mb-2 print:text-black",children:"Total Value"}),(0,s.jsx)("div",{className:"text-3xl font-bold text-[#22c55e]",children:(0,d.$g)(E,g)}),(0,s.jsx)("div",{className:"text-xs text-gray-500 mt-2",children:"Current market value"})]}),(0,s.jsxs)("div",{className:"bg-[#1f2533] p-6 rounded-xl border border-[#2a3142] print:border-black print:bg-white",children:[(0,s.jsx)("h3",{className:"text-gray-400 uppercase text-xs font-bold mb-2 print:text-black",children:"Total Invested"}),(0,s.jsx)("div",{className:"text-3xl font-bold text-white print:text-black",children:(0,d.$g)(G,g)}),(0,s.jsx)("div",{className:"text-xs text-gray-500 mt-2",children:"Based on paid price"})]}),(0,s.jsxs)("div",{className:"bg-[#1f2533] p-6 rounded-xl border border-[#2a3142] print:border-black print:bg-white",children:[(0,s.jsx)("h3",{className:"text-gray-400 uppercase text-xs font-bold mb-2 print:text-black",children:"Total Profit"}),(0,s.jsxs)("div",{className:"text-3xl font-bold ".concat(L&&L>=0?"text-[#22c55e]":"text-red-500"),children:[L&&L>0?"+":"",(0,d.$g)(L,g)]}),(0,s.jsx)("div",{className:"text-xs text-gray-500 mt-2",children:"Unrealized gains"})]}),(0,s.jsxs)("div",{className:"bg-[#1f2533] p-6 rounded-xl border border-[#2a3142] print:border-black print:bg-white",children:[(0,s.jsx)("h3",{className:"text-gray-400 uppercase text-xs font-bold mb-2 print:text-black",children:"Most Valuable"}),(null==v?void 0:null===(e=v.top_items)||void 0===e?void 0:e[0])?(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-lg font-bold text-white truncate print:text-black",title:v.top_items[0].name,children:v.top_items[0].name}),(0,s.jsx)("div",{className:"text-[#ff6600] font-bold text-xl",children:(0,d.$g)((0,d.Tt)(v.top_items[0].value,g),g)})]}):(0,s.jsx)("div",{className:"text-gray-500",children:"No items yet"})]})]}),(0,s.jsxs)("div",{className:"bg-[#1f2533] p-6 rounded-xl border border-[#2a3142] mb-8 print:border-black print:bg-white print:break-inside-avoid",children:[(0,s.jsx)("h3",{className:"text-xl font-bold mb-6 print:text-black",children:"Value History (Calculated from Acquisition)"}),(0,s.jsx)("div",{className:"h-[300px] w-full",children:S&&P.length>0?(0,s.jsx)(c.u,{width:"100%",height:"100%",children:(0,s.jsxs)(x.Q,{data:P,children:[(0,s.jsxs)("defs",{children:[(0,s.jsxs)("linearGradient",{id:"colorValue",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,s.jsx)("stop",{offset:"5%",stopColor:"#22c55e",stopOpacity:.3}),(0,s.jsx)("stop",{offset:"95%",stopColor:"#22c55e",stopOpacity:0})]}),(0,s.jsxs)("linearGradient",{id:"colorInvested",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,s.jsx)("stop",{offset:"5%",stopColor:"#ef4444",stopOpacity:.3}),(0,s.jsx)("stop",{offset:"95%",stopColor:"#ef4444",stopOpacity:0})]})]}),(0,s.jsx)(b.d,{strokeDasharray:"3 3",stroke:"#2a3142",vertical:!1}),(0,s.jsx)(m.W,{dataKey:"date",tickFormatter:e=>{if(!e)return"";let t=new Date(e);return isNaN(t.getTime())?"":t.getDate().toString()},stroke:"#6b7280",tickLine:!1,axisLine:!1}),(0,s.jsx)(p.h,{stroke:"#6b7280",tickLine:!1,axisLine:!1,tickFormatter:e=>{let t="EUR"===g?"€":"GBP"===g?"\xa3":"$";return e>=1e3?"".concat(t).concat((e/1e3).toFixed(1),"k"):"".concat(t).concat(e)}}),(0,s.jsx)(h.m,{contentStyle:{backgroundColor:"#1f2533",borderColor:"#2a3142",color:"#fff"},formatter:(e,t)=>[(0,d.$g)(e,g),"value"===t?"Market Value":"Invested"],labelFormatter:e=>{if(!e)return"";let t=new Date(e);return isNaN(t.getTime())?"":t.toLocaleDateString()}}),(0,s.jsx)(f.Gk,{type:"monotone",dataKey:"value",name:"value",stroke:"#22c55e",strokeWidth:3,fillOpacity:1,fill:"url(#colorValue)"}),(0,s.jsx)(f.Gk,{type:"monotone",dataKey:"invested",name:"invested",stroke:"#ef4444",strokeWidth:2,fillOpacity:1,fill:"url(#colorInvested)"})]})}):(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-gray-500 gap-4",children:[(0,s.jsx)("p",{children:S?"No history data available yet.":"Loading chart..."}),_&&(0,s.jsxs)("div",{className:"text-xs font-mono text-left bg-black p-4 rounded border border-gray-700 max-w-lg overflow-auto",children:[(0,s.jsx)("p",{className:"font-bold text-[#ff6600] mb-2",children:"DEBUG INFO:"}),(0,s.jsx)("pre",{children:JSON.stringify(_,null,2)})]})]})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 print:grid-cols-1",children:[(0,s.jsxs)("div",{className:"bg-[#1f2533] p-6 rounded-xl border border-[#2a3142] print:border-black print:bg-white print:break-inside-avoid",children:[(0,s.jsx)("h3",{className:"text-xl font-bold mb-4 print:text-black",children:"Top 5 Most Valuable"}),null==v?void 0:null===(t=v.top_items)||void 0===t?void 0:t.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center justify-between py-3 border-b border-[#2a3142] last:border-0 print:border-gray-200",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)("span",{className:"text-gray-500 font-mono w-4",children:["#",t+1]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-bold print:text-black",children:e.name}),(0,s.jsx)("div",{className:"text-xs text-gray-400",children:e.console})]})]}),(0,s.jsx)("div",{className:"font-bold text-[#ff6600]",children:(0,d.$g)((0,d.Tt)(e.value,g),g)})]},t))]}),(0,s.jsxs)("div",{className:"bg-[#1f2533] p-6 rounded-xl border border-[#2a3142] print:border-black print:bg-white print:break-inside-avoid",children:[(0,s.jsx)("h3",{className:"text-xl font-bold mb-4 print:text-black",children:"Top Movers (30 Days)"}),(null==k?void 0:k.gainers)&&k.gainers.length>0?k.gainers.slice(0,5).map((e,t)=>{let r=(0,d.Tt)(e.current_price,g),l=(0,d.Tt)(e.abs_change,g);return(0,s.jsxs)("div",{className:"flex items-center justify-between py-3 border-b border-[#2a3142] last:border-0 print:border-gray-200",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)("div",{className:"text-green-500 bg-green-500/10 px-2 py-1 rounded text-xs font-bold",children:["+",e.pct_change,"%"]}),(0,s.jsx)("div",{children:(0,s.jsx)("div",{className:"font-bold print:text-black",children:e.name})})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("div",{className:"font-bold text-white print:text-black",children:(0,d.$g)(r,g)}),(0,s.jsxs)("div",{className:"text-xs text-green-500",children:["+",(0,d.$g)(l,g)]})]})]},t)}):(0,s.jsx)("div",{className:"text-gray-500 text-center py-8",children:"No significant movement yet."})]})]})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[651,839,968,78,441,517,358],()=>t(87181)),_N_E=e.O()}]);