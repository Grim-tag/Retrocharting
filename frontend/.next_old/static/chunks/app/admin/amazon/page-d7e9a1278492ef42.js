(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6919],{10811:(e,t,r)=>{Promise.resolve().then(r.bind(r,27334))},80022:(e,t,r)=>{"use strict";r.d(t,{G_:()=>n,j:()=>i});var o=r(12115);let a=(0,o.createContext)(null);function n(e){let{clientId:t,nonce:r,onScriptLoadSuccess:n,onScriptLoadError:l,children:i}=e,s=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{nonce:t,onScriptLoadSuccess:r,onScriptLoadError:a}=e,[n,l]=(0,o.useState)(!1),i=(0,o.useRef)(r);i.current=r;let s=(0,o.useRef)(a);return s.current=a,(0,o.useEffect)(()=>{let e=document.createElement("script");return e.src="https://accounts.google.com/gsi/client",e.async=!0,e.defer=!0,e.nonce=t,e.onload=()=>{var e;l(!0),null===(e=i.current)||void 0===e||e.call(i)},e.onerror=()=>{var e;l(!1),null===(e=s.current)||void 0===e||e.call(s)},document.body.appendChild(e),()=>{document.body.removeChild(e)}},[t]),n}({nonce:r,onScriptLoadSuccess:n,onScriptLoadError:l}),c=(0,o.useMemo)(()=>({clientId:t,scriptLoadedSuccessfully:s}),[t,s]);return o.createElement(a.Provider,{value:c},i)}let l={large:40,medium:32,small:20};function i(e){let{onSuccess:t,onError:r,useOneTap:n,promptMomentNotification:i,type:s="standard",theme:c="outline",size:d="large",text:u,shape:h,logo_alignment:v,width:m,locale:p,click_listener:f,containerProps:g,...x}=e,y=(0,o.useRef)(null),{clientId:b,scriptLoadedSuccessfully:w}=function(){let e=(0,o.useContext)(a);if(!e)throw Error("Google OAuth components must be used within GoogleOAuthProvider");return e}(),N=(0,o.useRef)(t);N.current=t;let _=(0,o.useRef)(r);_.current=r;let j=(0,o.useRef)(i);return j.current=i,(0,o.useEffect)(()=>{var e,t,r,o,a,l,i,g,C;if(w)return null===(r=null===(t=null===(e=null==window?void 0:window.google)||void 0===e?void 0:e.accounts)||void 0===t?void 0:t.id)||void 0===r||r.initialize({client_id:b,callback:e=>{var t,r;if(!(null==e?void 0:e.credential))return null===(t=_.current)||void 0===t?void 0:t.call(_);let{credential:o,select_by:a}=e;N.current({credential:o,clientId:null!==(r=null==e?void 0:e.clientId)&&void 0!==r?r:null==e?void 0:e.client_id,select_by:a})},...x}),null===(l=null===(a=null===(o=null==window?void 0:window.google)||void 0===o?void 0:o.accounts)||void 0===a?void 0:a.id)||void 0===l||l.renderButton(y.current,{type:s,theme:c,size:d,text:u,shape:h,logo_alignment:v,width:m,locale:p,click_listener:f}),n&&(null===(C=null===(g=null===(i=null==window?void 0:window.google)||void 0===i?void 0:i.accounts)||void 0===g?void 0:g.id)||void 0===C||C.prompt(j.current)),()=>{var e,t,r;n&&(null===(r=null===(t=null===(e=null==window?void 0:window.google)||void 0===e?void 0:e.accounts)||void 0===t?void 0:t.id)||void 0===r||r.cancel())}},[b,w,n,s,c,d,u,h,v,m,p]),o.createElement("div",{...g,ref:y,style:{height:l[d],...null==g?void 0:g.style}})}},27334:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var o=r(95155),a=r(12115),n=r(68435),l=r(93681);function i(){let{token:e}=(0,n.A)(),[t,r]=(0,a.useState)(null),[i,d]=(0,a.useState)(!0),[u,h]=(0,a.useState)(null),v=async()=>{if(e){d(!0),h(null);try{let e=await l.u.get("/admin/amazon-stats");r(e.data)}catch(e){var t,o;console.error("Failed to load amazon stats",e),h((null===(o=e.response)||void 0===o?void 0:null===(t=o.data)||void 0===t?void 0:t.detail)||e.message||"Unknown error")}finally{d(!1)}}};if((0,a.useEffect)(()=>{v()},[e]),i)return(0,o.jsx)("div",{className:"text-white p-8 animate-pulse",children:"Loading Amazon data..."});if(u)return(0,o.jsx)("div",{className:"p-8",children:(0,o.jsxs)("div",{className:"bg-red-500/10 border border-red-500 text-red-500 p-4 rounded",children:[(0,o.jsx)("h3",{className:"font-bold",children:"Failed to load data"}),(0,o.jsx)("p",{className:"font-mono text-sm mt-2",children:u}),(0,o.jsx)("button",{onClick:v,className:"mt-4 px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600",children:"Retry"})]})});if(!t)return(0,o.jsx)("div",{className:"text-red-400 p-8",children:"No data available."});let m=t.total_products_with_amazon,p=m>0?(t.region_counts.PAL/m*100).toFixed(1):0,f=m>0?(t.region_counts.NTSC/m*100).toFixed(1):0,g=m>0?(t.region_counts.JP/m*100).toFixed(1):0;return(0,o.jsxs)("div",{className:"space-y-8 animate-fade-in",children:[(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-6",children:[(0,o.jsx)(s,{label:"Total Covered",value:m.toLocaleString(),subtext:"Products with at least 1 Amazon listing",highlight:!0}),(0,o.jsx)(s,{label:"Barcodes (EAN)",value:t.products_with_ean.toLocaleString(),subtext:"Products with verified EAN/UPC",status:"blue"}),(0,o.jsx)(s,{label:"PAL Coverage",value:t.region_counts.PAL.toLocaleString(),subtext:"".concat(p,"% of covered items"),status:"blue"}),(0,o.jsx)(s,{label:"NTSC Coverage",value:t.region_counts.NTSC.toLocaleString(),subtext:"".concat(f,"% of covered items"),status:"green"}),(0,o.jsx)(s,{label:"JP Coverage",value:t.region_counts.JP.toLocaleString(),subtext:"".concat(g,"% of covered items"),status:"red"})]}),(0,o.jsxs)("div",{className:"bg-[#1f2533] border border-[#2a3142] rounded-lg overflow-hidden",children:[(0,o.jsxs)("div",{className:"p-6 border-b border-[#2a3142] flex justify-between items-center",children:[(0,o.jsx)("h2",{className:"text-xl font-bold text-white",children:"Recent Amazon Updates"}),(0,o.jsxs)("div",{className:"flex gap-2",children:[(0,o.jsx)("button",{onClick:async()=>{try{await l.u.post("/admin/enrich/ean-backfill",{},{params:{limit:100}}),alert("Turbo Backfill Started (100 items). Refresh stats in a moment.")}catch(e){alert("Failed to start backfill")}},className:"px-4 py-2 text-sm bg-blue-600 hover:bg-blue-700 text-white rounded transition-colors",children:"âš¡ Turbo Backfill EAN"}),(0,o.jsx)("button",{onClick:v,className:"px-4 py-2 text-sm bg-[#2a3142] hover:bg-[#343b4d] text-gray-300 rounded transition-colors",children:"Refresh"})]})]}),(0,o.jsx)("div",{className:"overflow-x-auto",children:(0,o.jsxs)("table",{className:"w-full text-left text-sm text-gray-400",children:[(0,o.jsx)("thead",{className:"bg-[#2a3142] text-xs uppercase text-gray-200 font-medium",children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{className:"px-6 py-4",children:"Product"}),(0,o.jsx)("th",{className:"px-6 py-4",children:"Console"}),(0,o.jsx)("th",{className:"px-6 py-4",children:"Region"}),(0,o.jsx)("th",{className:"px-6 py-4",children:"Amazon Price"}),(0,o.jsx)("th",{className:"px-6 py-4 text-right",children:"Action"})]})}),(0,o.jsxs)("tbody",{className:"divide-y divide-[#2a3142]",children:[t.recent_listings.map((e,t)=>(0,o.jsxs)("tr",{className:"hover:bg-[#2a3142]/50 transition-colors",children:[(0,o.jsxs)("td",{className:"px-6 py-4 font-medium text-white",children:[e.product_name,(0,o.jsxs)("div",{className:"text-xs text-gray-500 font-normal truncate max-w-[200px]",title:e.amazon_title,children:["Matches: ",e.amazon_title]})]}),(0,o.jsx)("td",{className:"px-6 py-4",children:e.console_name}),(0,o.jsx)("td",{className:"px-6 py-4",children:(0,o.jsx)(c,{region:e.region})}),(0,o.jsxs)("td",{className:"px-6 py-4 text-white font-mono",children:[e.price," ",e.currency]}),(0,o.jsx)("td",{className:"px-6 py-4 text-right",children:(0,o.jsx)("a",{href:e.url,target:"_blank",rel:"noreferrer",className:"text-[#ff6600] hover:text-[#ff8533] hover:underline",children:"View Offer"})})]},t)),0===t.recent_listings.length&&(0,o.jsx)("tr",{children:(0,o.jsx)("td",{colSpan:5,className:"px-6 py-12 text-center text-gray-500",children:"No listings found yet."})})]})]})})]})]})}function s(e){let{label:t,value:r,subtext:a,highlight:n,status:l}=e;return(0,o.jsxs)("div",{className:"bg-[#1f2533] p-6 rounded border border-[#2a3142] relative overflow-hidden group hover:border-[#3d455c] transition-colors",children:[(0,o.jsxs)("div",{className:"text-gray-400 text-xs font-bold uppercase tracking-wider mb-2 flex justify-between items-center",children:[t,l&&(0,o.jsx)("span",{className:"h-2 w-2 rounded-full ".concat({green:"bg-green-500",red:"bg-red-500",blue:"bg-blue-500"}[l])})]}),(0,o.jsx)("div",{className:"text-3xl font-bold mb-1 ".concat(n?"text-[#ff6600]":"text-white"),children:r}),a&&(0,o.jsx)("div",{className:"text-xs text-gray-500",children:a})]})}function c(e){let{region:t}=e;return(0,o.jsx)("span",{className:"px-2 py-1 rounded text-xs border ".concat({PAL:"bg-blue-900/40 text-blue-300 border-blue-800",NTSC:"bg-green-900/40 text-green-300 border-green-800",JP:"bg-red-900/40 text-red-300 border-red-800"}[t]," font-medium"),children:t})}},68435:(e,t,r)=>{"use strict";r.d(t,{A:()=>d,AuthProvider:()=>c});var o=r(95155),a=r(12115),n=r(80022),l=r(85534),i=r(2818);let s=(0,a.createContext)(void 0);function c(e){let{children:t}=e,[r,c]=(0,a.useState)(null),[d,u]=(0,a.useState)(null),[h,v]=(0,a.useState)(!0);(0,a.useEffect)(()=>{let e=localStorage.getItem("rc_token");e?(u(e),(0,l.Ni)(e).then(e=>{e?c(e):p()}).finally(()=>v(!1))):v(!1)},[]);let m=async e=>{let t=await (0,l.XL)(e);t&&t.access_token&&(localStorage.setItem("rc_token",t.access_token),u(t.access_token),c(await (0,l.Ni)(t.access_token)))},p=()=>{localStorage.removeItem("rc_token"),u(null),c(null)},f=i.env.NEXT_PUBLIC_GOOGLE_CLIENT_ID||"";f||console.error("CRITICAL: NEXT_PUBLIC_GOOGLE_CLIENT_ID is missing. Google Login will fail.");let g=async()=>{d&&c(await (0,l.Ni)(d))};return(0,o.jsx)(n.G_,{clientId:f,children:(0,o.jsx)(s.Provider,{value:{user:r,token:d,login:m,logout:p,refreshUser:g,isAuthenticated:!!r,loading:h},children:t})})}function d(){let e=(0,a.useContext)(s);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},85534:(e,t,r)=>{"use strict";r.d(t,{$_:()=>w,CG:()=>j,Go:()=>C,Li:()=>p,Ni:()=>h,R1:()=>n,Ri:()=>i,Sb:()=>f,Sz:()=>c,T2:()=>d,TK:()=>g,UQ:()=>s,XL:()=>u,X_:()=>v,bC:()=>y,e9:()=>a,fA:()=>_,jg:()=>b,mQ:()=>N,nL:()=>m,updateProduct:()=>l,xM:()=>x});var o=r(93681);function a(){return o.H}async function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,r=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,i=arguments.length>6?arguments[6]:void 0;try{return(await o.u.get("/products/",{params:{console:e,limit:t,genre:r,type:a,sort:n,skip:l,search:i}})).data}catch(e){return console.error("Error fetching products:",e),[]}}async function l(e,t,r){try{return(await o.u.put("/products/".concat(e),t)).data}catch(t){return console.error("Error updating product ".concat(e,":"),t),null}}async function i(e){try{return(await o.u.get("/products/search/grouped",{params:{query:e}})).data}catch(e){return console.error("Error searching products grouped:",e),{}}}async function s(e){try{let t=await o.u.get("/products/".concat(e,"/listings"),{params:{_t:new Date().getTime()}}),r="true"===t.headers["x-is-stale"];return{data:t.data,isStale:r,status:t.status}}catch(e){var t;return{data:[],isStale:!1,status:(null===(t=e.response)||void 0===t?void 0:t.status)||500}}}async function c(e){try{return(await o.u.get("/products/".concat(e,"/related"))).data}catch(e){return console.error("Error fetching related products:",e),[]}}async function d(e,t,r,a){try{return await o.u.post("/translations/",{locale:e,key:t,value:r},{headers:{"X-Admin-Key":a}}),!0}catch(e){return console.error("Failed to save translation",e),!1}}async function u(e){try{return(await o.u.post("/auth/google",{credential:e})).data}catch(e){var t,r;throw console.error("Google Login failed",e),Error((null===(r=e.response)||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.detail)||e.message||"Login failed")}}async function h(e){try{return(await o.u.get("/auth/me")).data}catch(e){return null}}async function v(e){try{return(await o.u.get("/collection/")).data}catch(e){return console.error("Failed to fetch collection",e),[]}}async function m(e,t,r,a,n){try{return(await o.u.post("/collection/",{product_id:t,condition:r,paid_price:n,notes:a})).data}catch(e){var l,i;throw console.error("Failed to add to collection",e),Error((null===(i=e.response)||void 0===i?void 0:null===(l=i.data)||void 0===l?void 0:l.detail)||"Failed to add to collection")}}async function p(e,t,r){try{return(await o.u.put("/collection/".concat(t),r)).data}catch(e){var a,n;throw console.error("Failed to update collection item",e),Error((null===(n=e.response)||void 0===n?void 0:null===(a=n.data)||void 0===a?void 0:a.detail)||"Failed to update item")}}async function f(e,t){try{return await o.u.delete("/collection/".concat(t)),!0}catch(e){return console.error("Failed to delete item",e),!1}}async function g(e,t){try{return(await o.u.put("/auth/me",t)).data}catch(e){throw e}}async function x(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;arguments.length>1&&arguments[1];try{return(await o.u.get("/products/stats/recently-scraped",{params:{limit:e}})).data}catch(e){return console.error("Failed to fetch recently scraped products",e),[]}}async function y(e){try{return(await o.u.get("/portfolio/summary")).data}catch(e){return console.error("Failed to fetch portfolio summary",e),{total_value:0,item_count:0,console_count:0,top_items:[]}}}async function b(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;try{return(await o.u.get("/portfolio/history",{params:{range_days:t}})).data}catch(e){return console.error("Failed to fetch portfolio history",e),[]}}async function w(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;try{return(await o.u.get("/portfolio/movers",{params:{days:t}})).data}catch(e){return console.error("Failed to fetch portfolio movers",e),{gainers:[],losers:[]}}}async function N(e){try{return(await o.u.get("/portfolio/debug")).data}catch(e){return console.error("Failed to fetch portfolio debug",e),{error:"Failed to fetch debug info"}}}async function _(e){try{return(await o.u.get("/portfolio/dashboard")).data}catch(e){return console.error("Failed to fetch portfolio dashboard",e),null}}async function j(e,t){let r=new FormData;r.append("file",e);try{return(await o.u.post("/import/upload",r,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(e){var a,n;throw console.error("CSV upload failed",e),Error((null===(n=e.response)||void 0===n?void 0:null===(a=n.data)||void 0===a?void 0:a.detail)||"Upload failed")}}async function C(e,t){try{return(await o.u.post("/import/confirm",{items:e})).data}catch(e){var r,a;throw console.error("Bulk import failed",e),Error((null===(a=e.response)||void 0===a?void 0:null===(r=a.data)||void 0===r?void 0:r.detail)||"Import failed")}}},93681:(e,t,r)=>{"use strict";r.d(t,{H:()=>l,u:()=>i});var o=r(82651),a=r(2818);let n=a.env.NEXT_PUBLIC_API_URL?a.env.NEXT_PUBLIC_API_URL:"https://retrocharting-backend.onrender.com",l="".concat(n,"/api/v1"),i=o.A.create({baseURL:l,headers:{"Content-Type":"application/json"}});i.interceptors.request.use(e=>{{let t=localStorage.getItem("rc_token");t&&(e.headers.Authorization="Bearer ".concat(t))}return e},e=>Promise.reject(e)),i.interceptors.response.use(e=>e,e=>Promise.reject(e))}},e=>{var t=t=>e(e.s=t);e.O(0,[5714,2651,8441,1517,7358],()=>t(10811)),_N_E=e.O()}]);