(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7637],{70922:(e,r,t)=>{Promise.resolve().then(t.bind(t,26124))},26124:(e,r,t)=>{"use strict";t.d(r,{default:()=>d});var a=t(95155),s=t(12115),l=t(76046),o=t(48173),c=t.n(o),n=t(57606),i=t(2818);function d(){let e=(0,l.useParams)(),r=(0,l.useRouter)(),t=null==e?void 0:e.id,[o,d]=(0,s.useState)(!0),[u,p]=(0,s.useState)(!1),[x,b]=(0,s.useState)([]),[h,m]=(0,s.useState)({product_name:"",console_name:"",description:"",image_url:"",publisher:"",developer:"",genre:"",players:"",release_date:"",loose_price:0,cib_price:0,new_price:0});(0,s.useEffect)(()=>{(async()=>{if(t)try{let e=await fetch("".concat(i.env.NEXT_PUBLIC_API_URL,"/api/v1/products/").concat(t));if(e.ok){let r=await e.json();m({product_name:r.product_name||"",console_name:r.console_name||"",description:r.description||"",image_url:r.image_url||"",publisher:r.publisher||"",developer:r.developer||"",genre:r.genre||"",players:r.players||"",release_date:r.release_date||"",loose_price:r.loose_price||0,cib_price:r.cib_price||0,new_price:r.new_price||0})}let r=await fetch("".concat(i.env.NEXT_PUBLIC_API_URL,"/api/v1/products/").concat(t,"/history"));r.ok&&b(await r.json())}catch(e){console.error("Failed to load product",e)}finally{d(!1)}})()},[t]);let f=e=>{let{name:r,value:t}=e.target;m(e=>({...e,[r]:t}))},g=async e=>{e.preventDefault(),p(!0);try{let e=localStorage.getItem("rc_token");(await fetch("".concat(i.env.NEXT_PUBLIC_API_URL,"/api/v1/products/").concat(t),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(h)})).ok?(alert("Product updated successfully!"),r.push("/admin/health")):alert("Failed to update product.")}catch(e){console.error("Error updating",e),alert("Error updating product.")}finally{p(!1)}};return o?(0,a.jsx)("div",{className:"text-white p-8",children:"Loading..."}):(0,a.jsxs)("div",{className:"text-white max-w-4xl mx-auto p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4 mb-8",children:[(0,a.jsx)(c(),{href:"/admin/health",className:"text-gray-400 hover:text-white",children:"← Back to Health"}),(0,a.jsxs)("h1",{className:"text-2xl font-bold uppercase tracking-wider",children:["Edit Product (ID: ",t,")"]})]}),(0,a.jsxs)("form",{onSubmit:g,className:"bg-[#1f2533] p-8 rounded border border-[#2a3142] space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs uppercase text-gray-400 mb-1",children:"Product Name"}),(0,a.jsx)("input",{name:"product_name",value:h.product_name,onChange:f,className:"w-full bg-[#0f121e] border border-[#2a3142] p-2 rounded text-white"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs uppercase text-gray-400 mb-1",children:"Console"}),(0,a.jsx)("input",{name:"console_name",value:h.console_name,onChange:f,className:"w-full bg-[#0f121e] border border-[#2a3142] p-2 rounded text-white"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs uppercase text-gray-400 mb-1",children:"Image URL"}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)("input",{name:"image_url",value:h.image_url,onChange:f,className:"flex-1 bg-[#0f121e] border border-[#2a3142] p-2 rounded text-white"}),h.image_url&&(0,a.jsx)("img",{src:h.image_url,alt:"Preview",className:"h-10 w-10 object-cover rounded"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs uppercase text-gray-400 mb-1",children:"Description"}),(0,a.jsx)("textarea",{name:"description",rows:5,value:h.description,onChange:f,className:"w-full bg-[#0f121e] border border-[#2a3142] p-2 rounded text-white"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs uppercase text-gray-400 mb-1",children:"Publisher"}),(0,a.jsx)("input",{name:"publisher",value:h.publisher,onChange:f,className:"w-full bg-[#0f121e] border border-[#2a3142] p-2 rounded text-white"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs uppercase text-gray-400 mb-1",children:"Developer"}),(0,a.jsx)("input",{name:"developer",value:h.developer,onChange:f,className:"w-full bg-[#0f121e] border border-[#2a3142] p-2 rounded text-white"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs uppercase text-gray-400 mb-1",children:"Genre"}),(0,a.jsx)("input",{name:"genre",value:h.genre,onChange:f,className:"w-full bg-[#0f121e] border border-[#2a3142] p-2 rounded text-white"})]})]}),(0,a.jsxs)("div",{className:"p-4 bg-[#0f121e] rounded border border-[#2a3142]",children:[(0,a.jsx)("h3",{className:"text-[#ff6600] font-bold mb-4 text-sm",children:"Base Prices (Overrides Scraper)"}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs uppercase text-gray-400 mb-1",children:"Loose"}),(0,a.jsx)("input",{type:"number",step:"0.01",name:"loose_price",value:h.loose_price,onChange:f,className:"w-full bg-[#1f2533] border border-[#2a3142] p-2 rounded text-white"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs uppercase text-gray-400 mb-1",children:"CIB"}),(0,a.jsx)("input",{type:"number",step:"0.01",name:"cib_price",value:h.cib_price,onChange:f,className:"w-full bg-[#1f2533] border border-[#2a3142] p-2 rounded text-white"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs uppercase text-gray-400 mb-1",children:"New"}),(0,a.jsx)("input",{type:"number",step:"0.01",name:"new_price",value:h.new_price,onChange:f,className:"w-full bg-[#1f2533] border border-[#2a3142] p-2 rounded text-white"})]})]})]}),(0,a.jsxs)("div",{className:"p-4 bg-[#0f121e] rounded border border-[#2a3142]",children:[(0,a.jsx)("h3",{className:"text-white font-bold mb-4 text-sm uppercase",children:"Price History Data"}),(0,a.jsx)("div",{className:"h-64",children:x.length>0?(0,a.jsx)(n.default,{history:x}):(0,a.jsx)("p",{className:"text-gray-500 text-sm",children:"No history data available."})})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,a.jsx)(c(),{href:"/admin/health",className:"px-6 py-2 rounded border border-[#2a3142] hover:bg-[#2a3142] transition-colors",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:u,className:"px-6 py-2 rounded bg-[#ff6600] hover:bg-[#ff8533] text-white font-bold transition-colors",children:u?"Saving...":"Save Changes"})]})]})]})}},57606:(e,r,t)=>{"use strict";t.d(r,{default:()=>b});var a=t(95155),s=t(85572),l=t(94973),o=t(15255),c=t(12800),n=t(66963),i=t(71214),d=t(85608),u=t(11458),p=t(31558),x=t(11977);function b(e){let{history:r,className:t,dict:b}=e,{currency:h}=(0,p.H)(),m=(0,x.Qn)(h);if(!r||0===r.length){var f,g;return(0,a.jsx)("div",{className:"bg-[#1f2533] border border-[#2a3142] rounded flex items-center justify-center text-gray-500 ".concat(t||"h-[300px]"),children:(null==b?void 0:null===(g=b.product)||void 0===g?void 0:null===(f=g.market)||void 0===f?void 0:f.no_history)||"No price history available."})}let v={},j=new Set;r.forEach(e=>{let r=e.date;v[r]||(v[r]={date:r}),v[r][e.condition]=e.price,j.add(e.condition)});let y=Object.values(v).sort((e,r)=>new Date(e.date).getTime()-new Date(r.date).getTime()),N={loose:"#9ca3af",cib:"#007bff",new:"#00ff00",graded:"#a855f7",box_only:"#f59e0b",manual_only:"#ef4444"};return(0,a.jsx)("div",{className:"w-full bg-[#1f2533] border border-[#2a3142] p-4 rounded ".concat(t||"h-[400px]"),children:(0,a.jsx)(s.u,{width:"100%",height:"100%",children:(0,a.jsxs)(l.b,{data:y,children:[(0,a.jsx)(o.d,{strokeDasharray:"3 3",stroke:"#2a3142"}),(0,a.jsx)(c.W,{dataKey:"date",stroke:"#9ca3af",tick:{fill:"#9ca3af"},tickFormatter:e=>new Date(e).toLocaleDateString()}),(0,a.jsx)(n.h,{stroke:"#9ca3af",tick:{fill:"#9ca3af"},tickFormatter:e=>"".concat(m).concat(e)}),(0,a.jsx)(i.m,{contentStyle:{backgroundColor:"#1f2533",borderColor:"#2a3142",color:"#fff"},itemStyle:{color:"#fff"},labelStyle:{color:"#9ca3af"}}),(0,a.jsx)(d.s,{}),Array.from(j).map(e=>(0,a.jsx)(u.N1,{type:"monotone",dataKey:e,stroke:N[e]||"#fff",strokeWidth:2,dot:!1,activeDot:{r:6},connectNulls:!0},e))]})})})}},31558:(e,r,t)=>{"use strict";t.d(r,{CurrencyProvider:()=>o,H:()=>c});var a=t(95155),s=t(12115);let l=(0,s.createContext)(void 0);function o(e){let{children:r}=e,[t,o]=(0,s.useState)("USD");return(0,s.useEffect)(()=>{let e=localStorage.getItem("retrocharting_currency");e&&("USD"===e||"EUR"===e||"GBP"===e)&&o(e)},[]),(0,a.jsx)(l.Provider,{value:{currency:t,setCurrency:e=>{o(e),localStorage.setItem("retrocharting_currency",e)}},children:r})}function c(){let e=(0,s.useContext)(l);if(void 0===e)throw Error("useCurrency must be used within a CurrencyProvider");return e}},11977:(e,r,t)=>{"use strict";t.d(r,{$g:()=>n,Q3:()=>c,Qn:()=>l,Tt:()=>o,VK:()=>s});let a={USD:1,EUR:.95,GBP:.79},s=[{code:"USD",label:"USD ($)",symbol:"$"},{code:"EUR",label:"EUR (€)",symbol:"€"},{code:"GBP",label:"GBP (\xa3)",symbol:"\xa3"}];function l(e){let r=s.find(r=>r.code===e);return r?r.symbol:"$"}function o(e,r){return null==e?null:e*(a[r]||1)}function c(e,r){let t=a[r]||1;return 0===t?0:e/t}function n(e,r){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"en-US";if(null==e)return"--";let a=o(e,r);if(null===a)return"--";try{return new Intl.NumberFormat(t,{style:"currency",currency:r}).format(a)}catch(e){return"".concat(r," ").concat(a.toFixed(2))}}}},e=>{var r=r=>e(e.s=r);e.O(0,[5714,8173,6802,4619,8441,1517,7358],()=>r(70922)),_N_E=e.O()}]);