(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5717],{85791:(t,e,r)=>{Promise.resolve().then(r.bind(r,96713))},80022:(t,e,r)=>{"use strict";r.d(e,{G_:()=>n,j:()=>i});var o=r(12115);let a=(0,o.createContext)(null);function n(t){let{clientId:e,nonce:r,onScriptLoadSuccess:n,onScriptLoadError:l,children:i}=t,c=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{nonce:e,onScriptLoadSuccess:r,onScriptLoadError:a}=t,[n,l]=(0,o.useState)(!1),i=(0,o.useRef)(r);i.current=r;let c=(0,o.useRef)(a);return c.current=a,(0,o.useEffect)(()=>{let t=document.createElement("script");return t.src="https://accounts.google.com/gsi/client",t.async=!0,t.defer=!0,t.nonce=e,t.onload=()=>{var t;l(!0),null===(t=i.current)||void 0===t||t.call(i)},t.onerror=()=>{var t;l(!1),null===(t=c.current)||void 0===t||t.call(c)},document.body.appendChild(t),()=>{document.body.removeChild(t)}},[e]),n}({nonce:r,onScriptLoadSuccess:n,onScriptLoadError:l}),u=(0,o.useMemo)(()=>({clientId:e,scriptLoadedSuccessfully:c}),[e,c]);return o.createElement(a.Provider,{value:u},i)}let l={large:40,medium:32,small:20};function i(t){let{onSuccess:e,onError:r,useOneTap:n,promptMomentNotification:i,type:c="standard",theme:u="outline",size:s="large",text:d,shape:h,logo_alignment:v,width:f,locale:m,click_listener:p,containerProps:g,...y}=t,w=(0,o.useRef)(null),{clientId:b,scriptLoadedSuccessfully:_}=function(){let t=(0,o.useContext)(a);if(!t)throw Error("Google OAuth components must be used within GoogleOAuthProvider");return t}(),x=(0,o.useRef)(e);x.current=e;let E=(0,o.useRef)(r);E.current=r;let P=(0,o.useRef)(i);return P.current=i,(0,o.useEffect)(()=>{var t,e,r,o,a,l,i,g,N;if(_)return null===(r=null===(e=null===(t=null==window?void 0:window.google)||void 0===t?void 0:t.accounts)||void 0===e?void 0:e.id)||void 0===r||r.initialize({client_id:b,callback:t=>{var e,r;if(!(null==t?void 0:t.credential))return null===(e=E.current)||void 0===e?void 0:e.call(E);let{credential:o,select_by:a}=t;x.current({credential:o,clientId:null!==(r=null==t?void 0:t.clientId)&&void 0!==r?r:null==t?void 0:t.client_id,select_by:a})},...y}),null===(l=null===(a=null===(o=null==window?void 0:window.google)||void 0===o?void 0:o.accounts)||void 0===a?void 0:a.id)||void 0===l||l.renderButton(w.current,{type:c,theme:u,size:s,text:d,shape:h,logo_alignment:v,width:f,locale:m,click_listener:p}),n&&(null===(N=null===(g=null===(i=null==window?void 0:window.google)||void 0===i?void 0:i.accounts)||void 0===g?void 0:g.id)||void 0===N||N.prompt(P.current)),()=>{var t,e,r;n&&(null===(r=null===(e=null===(t=null==window?void 0:window.google)||void 0===t?void 0:t.accounts)||void 0===e?void 0:e.id)||void 0===r||r.cancel())}},[b,_,n,c,u,s,d,h,v,f,m]),o.createElement("div",{...g,ref:w,style:{height:l[s],...null==g?void 0:g.style}})}},76046:(t,e,r)=>{"use strict";var o=r(66658);r.o(o,"useParams")&&r.d(e,{useParams:function(){return o.useParams}}),r.o(o,"usePathname")&&r.d(e,{usePathname:function(){return o.usePathname}}),r.o(o,"useRouter")&&r.d(e,{useRouter:function(){return o.useRouter}}),r.o(o,"useSearchParams")&&r.d(e,{useSearchParams:function(){return o.useSearchParams}})},96713:(t,e,r)=>{"use strict";r.d(e,{default:()=>c});var o=r(95155),a=r(12115),n=r(68435),l=r(85534),i=r(76046);function c(t){let{lang:e}=t,{user:r,token:c,refreshUser:u}=(0,n.A)(),[s,d]=(0,a.useState)(""),[h,v]=(0,a.useState)(""),[f,m]=(0,a.useState)(!1),p=(0,i.useRouter)(),g=async t=>{if(t.preventDefault(),v(""),!s||s.length<3){v("Username must be at least 3 characters.");return}m(!0);try{await (0,l.TK)(c,{username:s}),await u(),p.push("/".concat(e,"/collection"))}catch(t){v("Username already taken or invalid.")}finally{m(!1)}};return r?(0,o.jsx)("div",{className:"min-h-screen bg-[#0f121e] flex flex-col items-center justify-center p-4 text-white",children:(0,o.jsxs)("div",{className:"max-w-md w-full bg-[#1f2533] border border-[#2a3142] rounded-xl p-8 shadow-2xl",children:[(0,o.jsxs)("div",{className:"text-center mb-8",children:[(0,o.jsx)("img",{src:r.avatar_url,alt:"Avatar",className:"w-20 h-20 rounded-full mx-auto mb-4 border-4 border-[#ff6600]"}),(0,o.jsx)("h1",{className:"text-2xl font-bold mb-2",children:"Welcome!"}),(0,o.jsx)("p",{className:"text-gray-400",children:"Please choose a unique username to start your collection."})]}),(0,o.jsxs)("form",{onSubmit:g,children:[(0,o.jsxs)("div",{className:"mb-6",children:[(0,o.jsx)("label",{className:"block text-sm font-bold mb-2 text-gray-300",children:"Username"}),(0,o.jsx)("input",{type:"text",className:"w-full bg-[#0f121e] border border-[#3a4152] rounded p-3 text-white focus:border-[#ff6600] outline-none transition-colors",placeholder:"e.g. RetroKing99",value:s,onChange:t=>d(t.target.value)}),h&&(0,o.jsx)("p",{className:"text-red-500 text-xs mt-2",children:h})]}),(0,o.jsx)("button",{type:"submit",disabled:f,className:"w-full bg-[#ff6600] hover:bg-[#e65c00] text-white font-bold py-3 rounded-lg transition-colors disabled:opacity-50",children:f?"Setting up...":"Start Collecting"})]})]})}):null}},68435:(t,e,r)=>{"use strict";r.d(e,{A:()=>s,AuthProvider:()=>u});var o=r(95155),a=r(12115),n=r(80022),l=r(85534),i=r(2818);let c=(0,a.createContext)(void 0);function u(t){let{children:e}=t,[r,u]=(0,a.useState)(null),[s,d]=(0,a.useState)(null),[h,v]=(0,a.useState)(!0);(0,a.useEffect)(()=>{let t=localStorage.getItem("rc_token");t?(d(t),(0,l.Ni)(t).then(t=>{t?u(t):m()}).finally(()=>v(!1))):v(!1)},[]);let f=async t=>{let e=await (0,l.XL)(t);e&&e.access_token&&(localStorage.setItem("rc_token",e.access_token),d(e.access_token),u(await (0,l.Ni)(e.access_token)))},m=()=>{localStorage.removeItem("rc_token"),d(null),u(null)},p=i.env.NEXT_PUBLIC_GOOGLE_CLIENT_ID||"";p||console.error("CRITICAL: NEXT_PUBLIC_GOOGLE_CLIENT_ID is missing. Google Login will fail.");let g=async()=>{s&&u(await (0,l.Ni)(s))};return(0,o.jsx)(n.G_,{clientId:p,children:(0,o.jsx)(c.Provider,{value:{user:r,token:s,login:f,logout:m,refreshUser:g,isAuthenticated:!!r,loading:h},children:e})})}function s(){let t=(0,a.useContext)(c);if(void 0===t)throw Error("useAuth must be used within an AuthProvider");return t}},85534:(t,e,r)=>{"use strict";r.d(e,{$_:()=>_,CG:()=>P,Go:()=>N,Li:()=>m,Ni:()=>h,R1:()=>n,Ri:()=>i,Sb:()=>p,Sz:()=>u,T2:()=>s,TK:()=>g,UQ:()=>c,XL:()=>d,X_:()=>v,bC:()=>w,e9:()=>a,fA:()=>E,jg:()=>b,mQ:()=>x,nL:()=>f,updateProduct:()=>l,xM:()=>y});var o=r(93681);function a(){return o.H}async function n(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,r=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,i=arguments.length>6?arguments[6]:void 0;try{return(await o.u.get("/products/",{params:{console:t,limit:e,genre:r,type:a,sort:n,skip:l,search:i}})).data}catch(t){return console.error("Error fetching products:",t),[]}}async function l(t,e,r){try{return(await o.u.put("/products/".concat(t),e)).data}catch(e){return console.error("Error updating product ".concat(t,":"),e),null}}async function i(t){try{return(await o.u.get("/products/search/grouped",{params:{query:t}})).data}catch(t){return console.error("Error searching products grouped:",t),{}}}async function c(t){try{let e=await o.u.get("/products/".concat(t,"/listings"),{params:{_t:new Date().getTime()}}),r="true"===e.headers["x-is-stale"];return{data:e.data,isStale:r,status:e.status}}catch(t){var e;return{data:[],isStale:!1,status:(null===(e=t.response)||void 0===e?void 0:e.status)||500}}}async function u(t){try{return(await o.u.get("/products/".concat(t,"/related"))).data}catch(t){return console.error("Error fetching related products:",t),[]}}async function s(t,e,r,a){try{return await o.u.post("/translations/",{locale:t,key:e,value:r},{headers:{"X-Admin-Key":a}}),!0}catch(t){return console.error("Failed to save translation",t),!1}}async function d(t){try{return(await o.u.post("/auth/google",{credential:t})).data}catch(t){var e,r;throw console.error("Google Login failed",t),Error((null===(r=t.response)||void 0===r?void 0:null===(e=r.data)||void 0===e?void 0:e.detail)||t.message||"Login failed")}}async function h(t){try{return(await o.u.get("/auth/me")).data}catch(t){return null}}async function v(t){try{return(await o.u.get("/collection/")).data}catch(t){return console.error("Failed to fetch collection",t),[]}}async function f(t,e,r,a,n){try{return(await o.u.post("/collection/",{product_id:e,condition:r,paid_price:n,notes:a})).data}catch(t){var l,i;throw console.error("Failed to add to collection",t),Error((null===(i=t.response)||void 0===i?void 0:null===(l=i.data)||void 0===l?void 0:l.detail)||"Failed to add to collection")}}async function m(t,e,r){try{return(await o.u.put("/collection/".concat(e),r)).data}catch(t){var a,n;throw console.error("Failed to update collection item",t),Error((null===(n=t.response)||void 0===n?void 0:null===(a=n.data)||void 0===a?void 0:a.detail)||"Failed to update item")}}async function p(t,e){try{return await o.u.delete("/collection/".concat(e)),!0}catch(t){return console.error("Failed to delete item",t),!1}}async function g(t,e){try{return(await o.u.put("/auth/me",e)).data}catch(t){throw t}}async function y(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;arguments.length>1&&arguments[1];try{return(await o.u.get("/products/stats/recently-scraped",{params:{limit:t}})).data}catch(t){return console.error("Failed to fetch recently scraped products",t),[]}}async function w(t){try{return(await o.u.get("/portfolio/summary")).data}catch(t){return console.error("Failed to fetch portfolio summary",t),{total_value:0,item_count:0,console_count:0,top_items:[]}}}async function b(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;try{return(await o.u.get("/portfolio/history",{params:{range_days:e}})).data}catch(t){return console.error("Failed to fetch portfolio history",t),[]}}async function _(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;try{return(await o.u.get("/portfolio/movers",{params:{days:e}})).data}catch(t){return console.error("Failed to fetch portfolio movers",t),{gainers:[],losers:[]}}}async function x(t){try{return(await o.u.get("/portfolio/debug")).data}catch(t){return console.error("Failed to fetch portfolio debug",t),{error:"Failed to fetch debug info"}}}async function E(t){try{return(await o.u.get("/portfolio/dashboard")).data}catch(t){return console.error("Failed to fetch portfolio dashboard",t),null}}async function P(t,e){let r=new FormData;r.append("file",t);try{return(await o.u.post("/import/upload",r,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(t){var a,n;throw console.error("CSV upload failed",t),Error((null===(n=t.response)||void 0===n?void 0:null===(a=n.data)||void 0===a?void 0:a.detail)||"Upload failed")}}async function N(t,e){try{return(await o.u.post("/import/confirm",{items:t})).data}catch(t){var r,a;throw console.error("Bulk import failed",t),Error((null===(a=t.response)||void 0===a?void 0:null===(r=a.data)||void 0===r?void 0:r.detail)||"Import failed")}}},93681:(t,e,r)=>{"use strict";r.d(e,{H:()=>l,u:()=>i});var o=r(82651),a=r(2818);let n=a.env.NEXT_PUBLIC_API_URL?a.env.NEXT_PUBLIC_API_URL:"https://retrocharting-backend.onrender.com",l="".concat(n,"/api/v1"),i=o.A.create({baseURL:l,headers:{"Content-Type":"application/json"}});i.interceptors.request.use(t=>{{let e=localStorage.getItem("rc_token");e&&(t.headers.Authorization="Bearer ".concat(e))}return t},t=>Promise.reject(t)),i.interceptors.response.use(t=>t,t=>Promise.reject(t))}},t=>{var e=e=>t(t.s=e);t.O(0,[5714,2651,8441,1517,7358],()=>e(85791)),_N_E=t.O()}]);